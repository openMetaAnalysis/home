<!DOCTYPE html>
<html lang="en">
<!-- Change all events in intervention to 40; then change all events in intervention among high-dose studies to 25 -->
<head>
<title>openMetaAnalysis - editor</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<!-- jquery -->
<script src="//code.jquery.com/jquery-2.1.3.min.js"> </script>

<!-- tooltip -->
<script type="text/javascript" src="qtip/jquery.qtip.min.js"></script>
<link rel="stylesheet" type="text/css" href="qtip/jquery.qtip.min.css" />

<!-- ocpu library -->
<script src="opencpu/opencpu-0.4.js"> </script>

<!-- some optional styling stuff -->
<!-- 
<link href="bootstrap/css/bootstrap.min.css" rel="stylesheet" media="screen">
-->
<link href="jqueryui/css/ui-lightness/jquery-ui-1.10.3.custom.css" rel="stylesheet" media="screen"> 

<script src="bootstrap/js/bootstrap.js"> </script>
<script src="jqueryui/jquery-ui-1.10.3.custom.js"> </script>

<!-- jquery-csv from http://code.google.com/p/jquery-csv/ -->
<!-- <script src="https://jquery-csv.googlecode.com/git/src/jquery.csv.js"></script> -->
<script src="jquery-csv/jquery.csv.js"></script>

<!-- http://jqueryui.com/dialog/ -->
<script src="https://code.jquery.com/ui/1.10.3/jquery-ui.js"></script>

<!-- Ajax.org Cloud9 Editor from http://ace.c9.io/#nav=api&api=editor -->
<script src="src-min-noconflict/ace.js" type="text/javascript" charset="utf-8"></script>

<script> 
$(document).ready(function(){

  //optional, requires jquery-ui.
  $("#plotdiv").resizable()
  
$(function() {
$( "#dialog" ).dialog();
});

	var hash = window.location.hash 
	if (hash.length > 1) //location.hash.substring.length
		{
		if (hash.indexOf('instruct')>0 || hash.indexOf('teach')>0)
			{
			$("#column_names").css("display","inline")
			$(".fieldset").css("height","900px")
			$("#topic").val("Example data set")
			$("#measure").val("RR");
			//$(".hastip").css("display","inline")
			$(".teach").css("display","block")
			}
		}
	else
		{
		//$(".hastip").css("display","none")
		$(".teach").css("display","none")
		}
		
	if(isAPIAvailable()) {
	  $('#files').bind('change', handleFileSelect);
	}

  //For Ajax.org Cloud9 Editor
  var editor = ace.edit("editor");
  editor.setTheme("ace/theme/github");
  editor.getSession().setMode("ace/mode/r");
  editor.setFontSize("14px");
  editor.getSession().setUseWrapMode(true);
  
  // drawplot
  function drawplot(){
    $("#plotbutton").attr("disabled", "disabled")
	temp = editor.getSession().getValue()
	//Three replacements below are not required on a local server, but are at https://public.opencpu.org/ocpu/github/
	//temp = temp.replace(/\r?\n/g, '')
	temp = temp.replace(/\s+$/g, '')
	temp = temp.replace(/$\s+/g, '')
	temp = temp.replace(/,$/g, '')
	//var req = $('#target').contents().find('#plotdiv').rplot("intervention", {
	var req = $('#plotdiv').rplot("intervention", {
	  type: $("#type").val(),
	  sortby: $("#sortby").val(),
	  measure: $("#measure").val(),
	  analysis: $("#analysis").val(),
	  independent_variable: $("#independent_variable").val(),
	  cofactorlabel: $("#cofactorlabel").val(),
	  content: temp,
	  topic: $("#topic").val(),
	  lefthand: $("#lefthand").val(),
	  righthand: $("#righthand").val(),
	  label_location: $("#label_location").val(),
	  theme : $("#theme").val()
    }).always(function(){
      $("#plotbutton").removeAttr("disabled");
    }).fail(function(){
      alert("HTTP error " + req.status + ": " + req.responseText);
    });
  }

  //button handlers
  $("#plotbutton").on("click", function(e){
    e.preventDefault();
    drawplot();
  });

  $("#showeditor").on("click", function(e){
    e.preventDefault();
    if ($("#editorcontainer").css("display") == "none"){
		$("#editorcontainer").css("display","inline")
		$("#target").css("display","inline")
		$("#introduction").css("display","none")
		}
	else {
		$("#introduction").css("display","inline")
		$("#editorcontainer").css("display","none")
		$("#target").css("display","none")
	}
  });

  $("#instructor").on("click", function(e){
    e.preventDefault();
    if ($("#column_names").css("display") == "none"){
		$("#column_names").css("display","inline")
		$("#fieldset").css("height","900px")
		$("#topic").val("Example data set")
		$("#measure").val("RR");
		}
	else {
		$("#column_names").css("display","none")
		$("#fieldset").css("height","800px")
	}
  });

  $("#type").on("change", function(e){
    e.preventDefault();
	if ($("#type").val() == "ignore") // plain meta-analysis
		{
		$("#metaregression_form").css("display","none")
		$("#metaanalysis_form").css("display","block")
		$("#labels").css("display","block")
		}
    if ($("#type").val() == "metaregression")
		{
		$("#metaregression_form").css("display","block")
		$("#metaanalysis_form").css("display","none")
		$("#labels").css("display","none")
		}
    else //meta-analysis with subgroups
		{
		$("#metaregression_form").css("display","none")
		$("#metaanalysis_form").css("display","block")
		$("#labels").css("display","block")
		}
  });
  
  $("#independent_variable").on("change", function(e){
    e.preventDefault();
    if ($("#independent_variable").val() == "year")
		{
		$("#cofactorlabel").val("Year of publication");
		}
    else if($("#independent_variable").val() == "cr")
		{
		$("#cofactorlabel").val("Control rate");
		}
    else if($("#independent_variable").val() == "size")
		{
		$("#cofactorlabel").val("Study size");
		}
    else
		{
		$("#cofactorlabel").val("");
		}
  });

  $("#addcommas").on("click", function(e){
    e.preventDefault();
    temp = editor.getValue()
	temp = temp.replace(/\n/g, ',\n')
	temp = temp.replace(/$\s+/g, '')
	temp = temp.replace(/\s+$/g, '')
	temp = temp.replace(/ +/g, ', ')
	temp = temp.replace(/\t/g, ', ')
	temp = temp + ","
	temp = temp.replace(/,,/g, ',')
    editor.setValue(temp,1);
  });

  $(".example").click(function(){
	if($(this).val()=="ex_0") {
		$("#type").val("ignore");
		$("#metaregression_form").css("display","none");
		$("#metaanalysis_form").css("display","block");
		$("#cofactorlabel").css("display","none");
		$("#measure").val("RR");
		$("#sortby").val("year");
		$("#topic").val("'Soma' for reducing social discord (from Brave New World by Aldous Huxley)");
		editor.setValue("Wells, 2012, 12345678, 50, 100, 50, 100, high-dose,\nFord,  2013, 12345678, 50, 100, 50, 100, low-dose,\nFreud, 2014, 12345678, 50, 100, 50, 100, high-dose,\nPavlov, 2015, 12345678, 50, 100, 50, 100, low-dose,\nMalthus,2016, 12345678, 50, 100, 50, 100, high-dose,",1);
		}
	if($(this).val()=="ex_0a") {
		$("#type").val("ignore");
		$("#metaregression_form").css("display","none");
		$("#metaanalysis_form").css("display","block");
		$("#cofactorlabel").css("display","none");
		$("#measure").val("RR");
		$("#sortby").val("year");
		$("#topic").val("'Soma' for reducing social discord (from Brave New World by Aldous Huxley)");
		editor.setValue("Wells, 2012, 12345678, 50, 100, 50, 100, high-dose,\nFord,  2013, 12345678, 26, 100, 50, 100, low-dose,\nFreud, 2014, 12345678, 50, 100, 50, 100, high-dose,\nPavlov, 2015, 12345678, 24, 100, 50, 100, low-dose,\nMalthus,2016, 12345678, 50, 100, 50, 100, high-dose,",1);
		}
	if($(this).val()=="ex_0b") {
		$("#type").val("ignore");
		$("#metaregression_form").css("display","none");
		$("#metaanalysis_form").css("display","block");
		$("#cofactorlabel").css("display","none");
		$("#measure").val("SMD");
		$("#sortby").val("year");
		$("#topic").val("Chronic back pain treatment from tramadol (from PMID: 29204613)");
		editor.setValue("Schnitzer,2000,10743823, 3.5(2.79),127, 5.1(2.98),127,Trial not prospectively registered,4,\nRuoff  (Protocol CAPSS-112 Study Group),2003,12809961,4.44(1.45),161,5.23(1.49),157,Trial not prospectively registered,13,\nPeloso,2004,15570651,4.74(1.495),167,6.29(1.553),169,Trial not prospectively registered,12,\nVorsanger,2008,18557165,3.05(2.3),127,4.03(2.52),126,Trial not prospectively registered,12,\nUberall (SUPREME), 2012,22970658, 3.9(2),107, 4.1(4.1),110,Trial registered,4,\nLee (Ultracet ER Study Group),2013,24183364,-1.012(0.819),83,-0.792(0.966),87,Trial registered,4,\nSchiphorst,2014,24526247,5.1(2.81),24,4.5(2.96),25,Trial registered,2,",1);
		}
	  if($(this).val()=="ex_1a") {
		$("#type").val("ignore");
		$("#metaregression_form").css("display","none");
		$("#metaanalysis_form").css("display","block");
		$("#cofactorlabel").css("display","none");
		$("#measure").val("RR");
		$("#sortby").val("year");
		$("#topic").val("Vitamin D supplementation for fracture prevention");
		editor.setValue("Law, 2006, 16641143, 24, 1762, 20, 1955, 0,\nLips, 1996, 8554248, 135, 1291, 122, 1287, 0,\nLyons, 2007, 17473911, 202, 1725, 209, 1715, 0,\nTrivedi, 2003, 12609940, 43, 1345, 62, 1341, 0,\nChapuy, 1994, 8173430, 255, 1176, 308, 1127, 0,\nChapuy, 2002, 11991447, 97, 393, 55, 190, 0,\nDawson-Hughes, 1997, 9278463, 11, 187, 26, 202, 0,\nGrant, 2005, 15885294, 349, 2649, 341, 2643, 0,\nHarwood, 2000, 14695863, 8, 114, 5, 37, 0,\nJackson, 2006, 16481635, 2102, 18176, 2158, 18106, 0,\nMeyer, 2002, 11918228, 69, 569, 76, 575, 0,\nPfeifer, 2000, 10841179, 3, 70, 6, 67, 0,\nPfeifer, 2009, 18629569, 9, 121, 16, 121, 0,\nSalovaara, 2010, 20200964, 78, 1586, 94, 1609, 0,\nSanders, 2010, 20460620, 171, 1131, 135, 1125, 0,",1);
		}
	if($(this).val()=="ex_1b") {
		$("#type").val("subgroup1");
		$("#metaregression_form").css("display","none");
		$("#metaanalysis_form").css("display","block");
		$("#cofactorlabel").css("display","none");
		$("#measure").val("RR");
		$("#sortby").val("year");
		$("#topic").val("Vitamin D supplementation for fracture prevention");
		editor.setValue("Law, 2006, 16641143, 24, 1762, 20, 1955, 'INeffective dose',\nLips, 1996, 8554248, 135, 1291, 122, 1287, 'INeffective dose',\nLyons, 2007, 17473911, 202, 1725, 209, 1715, 'Effective dose',\nTrivedi, 2003, 12609940, 43, 1345, 62, 1341, 'Effective dose',\nChapuy, 1994, 8173430, 255, 1176, 308, 1127, 'Effective dose',\nChapuy, 2002, 11991447, 97, 393, 55, 190, 'Effective dose',\nDawson-Hughes, 1997, 9278463, 11, 187, 26, 202, 'Effective dose',\nGrant, 2005, 15885294, 349, 2649, 341, 2643, 'INeffective dose',\nHarwood, 2000, 14695863, 8, 114, 5, 37, 'INeffective dose',\nJackson, 2006, 16481635, 2102, 18176, 2158, 18106, 'INeffective dose',\nMeyer, 2002, 11918228, 69, 569, 76, 575, 'INeffective dose',\nPfeifer, 2000, 10841179, 3, 70, 6, 67, 'Effective dose',\nPfeifer, 2009, 18629569, 9, 121, 16, 121, 'Effective dose',\nSalovaara, 2010, 20200964, 78, 1586, 94, 1609, 'INeffective dose',\nSanders, 2010, 20460620, 171, 1131, 135, 1125, 'INeffective dose',",1);
		}
	if($(this).val()=="ex_2a") {
		$("#type").val("ignore");
		$("#measure").val("MD");
		$("#topic").val("Nebulised hypertonic saline solution for reducing length of stay from acute bronchiolitis in infants");
		//$("#measure").css("display","inline");
		$("#metaregression_form").css("display","none");
		$("#metaanalysis_form").css("display","block");
		$("#cofactorlabel").css("display","block");
		$("#measure").val("MD");
		$("#sortby").val("year");
		editor.setValue("Mandeberg, 2002, 12576370, 3(1.2), 27, 4(1.9), 25, HS,\nTal, 2006, 16599051, 2.6(1.4), 21, 3.5(1.7), 20, HS,\nKuzik, 2007, 17719935, 2.6(1.9), 47, 3.5(2.9), 49, HS,\nLuo, 2010, 19674354, 6(1.2), 50, 7.4(1.5), 43, HS,\nLuo, 2011, 20636429, 4.8(1.2), 57, 6.4(1.4), 55, HS,\nDel Giudice, 2012, 22697080, 4.9(1.3), 52, 5.6(1.6), 54, HS,\nWu, 2014, 24862623, 3.16(2.11), 197, 3.92(5.24) , 211, HS,",1);
		}
	if($(this).val()=="ex_3a") {
		$("#type").val("metaregression");
		$("#measure").val("MD");
		$("#topic").val("Vitamin D supplementation for fracture prevention");
		$("#metaregression_form").css("display","block");
		$("#metaanalysis_form").css("display","none");
		$("#cofactorlabel").css("display","block");
		$("#independent_variable").val("cf1");
		$("#type").val("metaregression");
		$("#cofactorlabel").val("Final vitamin D level");
		editor.setValue("Law, 2006, 16641143, 24, 1762, 20, 1955, 77,\nLips, 1996, 8554248, 135, 1291, 122, 1287, 54,\nLyons, 2007, 17473911, 202, 1725, 209, 1715, 80,\nTrivedi, 2003, 12609940, 43, 1345, 62, 1341, 74.3,\nChapuy, 1994, 8173430, 255, 1176, 308, 1127, 106,\nChapuy, 2002, 11991447, 97, 393, 55, 190, 77.5,\nDawson-Hughes, 1997, 9278463, 11, 187, 26, 202, 112,\nGrant, 2005, 15885294, 349, 2649, 341, 2643, 62,\nHarwood, 2000, 14695863, 8, 114, 5, 37, 44,\nJackson, 2006, 16481635, 2102, 18176, 2158, 18106, 61.4,\nMeyer, 2002, 11918228, 69, 569, 76, 575, 64,\nPfeifer, 2000, 10841179, 3, 70, 6, 67, 66.1,\nPfeifer, 2009, 18629569, 9, 121, 16, 121, 84.5,\nSalovaara, 2010, 20200964, 78, 1586, 94, 1609, 74.6,\nSanders, 2010, 20460620, 171, 1131, 135, 1125, 65,\n",1);
		}
	if($(this).val()=="ex_3b") {
		$("#type").val("metaregression");
		$("#measure").val("MD");
		$("#topic").val("Vitamin D supplementation for fracture prevention");
		$("#metaregression_form").css("display","block");
		$("#metaanalysis_form").css("display","none");
		$("#independent_variable").val("cf1");
		$("#cofactorlabel").val("Change in vitamin D level");
		$("#sortby").val("cofactor");
		editor.setValue("Law, 2006, 16641143, 24, 1762, 20, 1955, 18,\nLips, 1996, 8554248, 135, 1291, 122, 1287, 27,\nLyons, 2007, 17473911, 202, 1725, 209, 1715, 26,\nTrivedi, 2003, 12609940, 43, 1345, 62, 1341, 20.9,\nChapuy, 1994, 8173430, 255, 1176, 308, 1127, 66,\nChapuy, 2002, 11991447, 97, 393, 55, 190, 56.2,\nDawson-Hughes, 1997, 9278463, 11, 187, 26, 202, 35.2,\nGrant, 2005, 15885294, 349, 2649, 341, 2643, 24,\nHarwood, 2000, 14695863, 8, 114, 5, 37, 20.5,\nJackson, 2006, 16481635, 2102, 18176, 2158, 18106, 13.4,\nMeyer, 2002, 11918228, 69, 569, 76, 575, 17,\nPfeifer, 2000, 10841179, 3, 70, 6, 67, 40.4,\nPfeifer, 2009, 18629569, 9, 121, 16, 121, 29.1,\nSalovaara, 2010, 20200964, 78, 1586, 94, 1609, 24.6,\nSanders, 2010, 20460620, 171, 1131, 135, 1125, 8,\n",1);
		}
	if($(this).val()=="ex_3c") {
		$("#type").val("metaregression");
		$("#measure").val("RR");
		$("#topic").val("Early Goal-directed Therapy for Reducing Mortality in Septic Shock");
		$("#metaregression_form").css("display","block");
		$("#metaanalysis_form").css("display","none");
		$("#independent_variable").val("cf1");
		$("#cofactorlabel").val("Lactate acid level at baseline");
		$("#sortby").val("cofactor");
		editor.setValue("Rivers,            2001,11794169,  38, 130,  59, 133, 7.4,\nEGDT Collaborative,2010,20594464,  55, 157,  74, 146, NA,\nChen,              2007,18159013,  20,  58,  34,  65, NA,\nProCESS,           2014,24635773,  92, 439,  86, 456, 4.9,\nARISE,             2014,25272316, 115, 793, 125, 798, 6.6,\nProMISe,           2015,25776532, 184, 630, 181, 630, 6.9,\n\n",1);
		}
  });

  function isAPIAvailable() {
    // Check for the various File API support.
    if (window.File && window.FileReader && window.FileList && window.Blob) {
      // Great success! All the File APIs are supported.
      return true;
    } else {
      // source: File API availability - http://caniuse.com/#feat=fileapi
      // source: <output> availability - http://html5doctor.com/the-output-element/
      document.writeln('The HTML5 APIs used in this form are only available in the following browsers:<br />');
      // 6.0 File API & 13.0 <output>
      document.writeln(' - Google Chrome: 13.0 or later<br />');
      // 3.6 File API & 6.0 <output>
      document.writeln(' - Mozilla Firefox: 6.0 or later<br />');
      // 10.0 File API & 10.0 <output>
      document.writeln(' - Internet Explorer: Not supported (partial support expected in 10.0)<br />');
      // ? File API & 5.1 <output>
      document.writeln(' - Safari: Not supported<br />');
      // ? File API & 9.2 <output>
      document.writeln(' - Opera: Not supported');
      return false;
    }
  }

  function handleFileSelect(evt) {
    var files = evt.target.files; // FileList object
    var file = files[0];

    // read the file contents
    printTable(file);

  }

  function printTable(file) {
    var reader = new FileReader();
    reader.readAsText(file);
    reader.onload = function(event){
      var csv = event.target.result;
      var data = $.csv.toArrays(csv);
      var html = '';
      for(var row in data) {
	  if($("#header").val() == "FALSE" || [row] > 0 ){
        for(var item in data[row]) {
          html += data[row][item] + ', ';
        }
        html += '\r\n';
      }
	  }
      editor.setValue(html,1);

    };
    
	reader.onerror = function(){ alert('Unable to read ' + file.fileName); };
	}

	//http://qtip2.com/
	// Apply tooltip on all <a/> elements with title attributes. Mousing over
    // these elements will the show tooltip as expected, but mousing onto the
    // tooltip is now possible for interaction with it's contents.
    //$('a').each(function () {
    $('.hastip').each(function () {
        $(this).qtip({
            content: $(this).next('.tooltiptext'),
            hide: {
                fixed: true,
                delay: 300
            },
			position: {
				my: 'bottom left',  // Position my top left...
				at: 'bottom right', // at the bottom right of...
			},
			style: { classes: 'ToolTipClass'
			}
		});
    });

	$('.hastip').click(function(e) {
		e.stopPropagation();
		return false;
	});	

  //init on start
  //drawplot();
  
	//Ajax
	//http://api.jquery.com/jQuery.getJSON/
	//http://api.jquery.com/jQuery.ajax/
    //$.ajax({
		// you will need to replace this URL with the URL to your CSV file.
		//url: '/ocpu/github/badgettrg/openMetaAnalysis/www/data.csv',
		//dataType: 'json',
		//done: function (data) {
			//alert('success')
			//printTable(data)
		//}
	//});
  
});
</script>
<style>

.container
{
margin-top: 0px;
margin-right: auto;
margin-bottom: 0px;
margin-left: auto;
}
fieldset.options{
	border: 3px solid #6DC6E7;
	background-color: #FFFFFF;
	width:575px;height:100px;
}
#editor { 
  position: relative;
  width: 950px;
  height: 300px;
}
    
#plotdiv {
  width: 1000px;
  height: 400px;
  border: 1px solid #e3e3e3;
  border-radius: 4px;
}

#plotbutton{
  width: 120px;
  margin-left: 20px;
}

.twocolumns
{
columns:100px 2;
-webkit-columns:100px 2; /* Safari and Chrome */
-moz-columns:100px 2; /* Firefox */
}

/* Menu from http://codepen.io/philhoyt/pen/ujHzd */
#primary_nav_wrap
{
	margin-top:15px;
}

#primary_nav_wrap ul
{
	list-style:none;
	position:relative;
	float:left;
	margin:0;
	padding:0
}

#primary_nav_wrap ul a
{
	display:block;
	background-color:#6DC6E7;
	color:#FFFFFF;
	text-decoration:none;
	font-weight:bold;
	//font-weight:700;
	//font-size:12px;
	line-height:32px;
	padding:0 15px;
	//font-family:"HelveticaNeue","Helvetica Neue",Helvetica,Arial,sans-serif
}

#primary_nav_wrap ul li
{
	position:relative;
	float:left;
	margin:0;
	padding:0
}

#primary_nav_wrap ul li.current-menu-item
{
	background:#0022B4;
		color:#FFFFFF;
}

#primary_nav_wrap ul a:hover
{
	background:#0022B4;
	color:#FFFFFF;
}

#primary_nav_wrap ul ul
{
	display:none;
	position:absolute;
	top:100%;
	left:0;
	background-color:#6DC6E7;
	color:#FFFFFF;
	padding:0
}

#primary_nav_wrap ul ul li
{
	float:none;
	width:200px
}

#primary_nav_wrap ul ul a
{
	line-height:120%;
	padding:10px 15px;
}

#primary_nav_wrap ul ul ul
{
	top:0;
	left:100%
}

#primary_nav_wrap ul li:hover > ul
{
	display:block
}

ul.teach{
	font-style:italic;
	margin-left:5px;
	padding-left:10px;
	margin-top:1px;
	margin-bottom:1px;
}

/* Tooltip */
.tooltiptext{
	display: none;
}
.ToolTipClass{
color:black;
border-color:#0022B4;
background-color: #6DC6E7
}

</style>
</head>

<body>
<!-- 
http://jquery-csv.googlecode.com/git/examples/basic-usage.html
http://jquery-csv.googlecode.com/git/examples/flot.html -> seems best and most stable without reticulating spines error
http://code.google.com/p/jquery-csv/wiki/API -> instructions
-->
  <div class="container" style="width:1000px;">

    <div class="page-header">
      <div style="color:#0022B4">
	  <h1>openMetaAnalysis: <span style="font-size:50%">collaborative and continuous</span></h1>
	  </div>
<nav id="primary_nav_wrap">
<ul id="menu">
<li><a href="http://openmetaanalysis.github.io/" class="menuitem">Home</a></li>
<li><a href="#" class="menuitem">Plot editors</a>
	<ul>
	<li><a href="opencpu-launch.htm?https://openmetaanalysis.ocpu.io/home/www/editor.html" class="menuitem">Intervention</a></li>
	<li><a href="opencpu-launch.htm?https://openmetaanalysis.ocpu.io/home/www/editor.html#instruct" class="menuitem">Intervention (instructional)</a></li>
	<li><a href="opencpu-launch.htm?https://openmetaanalysis.ocpu.io/home/www/editor-dx.html" class="menuitem">Diagnosis</a></li>
	<li><a href="https://openmetaanalysis.ocpu.io/home/www/arrows.html" class="menuitem">Arrows Plot</a></li>
	</ul>
</li>
<li><a href="http://openmetaanalysis.github.io/methods.html" class="menuitem">Methods</a></li>
<li><a href="http://openmetaanalysis.github.io/new.html" class="menuitem">Create a new review</a></li>
<li><a href="http://openmetaanalysis.github.io/update.html" class="menuitem">Improve/update an existing review</a></li>
</ul>
</nav>
</div>
<div style="clear:both">&nbsp;</div>

	  <div id="editorcontainer" style="display:block">
      <div style="width:600px;float:left;">

        <form id="paramform" target="target" style="width:600px;">
          <fieldset style="border: 3px solid #6DC6E7; background-color: #FFFFFF;width:500px;height:800px;" id="fieldset">
            <legend style="font-weight:bold">Enter inputs</legend>
            <div>To perform a <a href="https://en.wikipedia.org/wiki/Meta-analysis">meta-analysis</a> of interventions:</div>
			<ul>
			<li>Revise or replace the example data below as needed or</li>
			<li>Upload a csv file formatted like these examples with <a href="example-d.csv">dichotomous</a> or <a href="example-c.csv">continous</a> outcomes.<br/>
			<input type=file id=files name=files style="width:200px"/>
			1st row is column names? <select id="header" name="header"><option value=TRUE> TRUE </option> <option value=FALSE> FALSE </option> </select>
			</li>
			</ul>
<div>Required columns: 1) study name, 2) year, 3) <a href="http://www.ncbi.nlm.nih.gov/books/NBK3827/#pubmedhelp.Unique_Identifier_PM">PMID</a>, 4) events of mean (SD) in intervention group, 5) total in intervention group, 6) events or mean (SD) in control group, 7) total in control group. <br/>
Optional columns for up to five cofactors<br/>
Separate columns with commas. <a id="addcommas" href="#">Click here</a> to add commas.</div>
<div >The initial data shown below is fictitious and is <a href="#" id="instructor">instructional</a>.</div>
<div id="column_names" style="display:none"><img src="column_names.png" alt="Image of column names"/></div>
<div id="editor" style="width:600px;">Downs, 2012, 12345678, 50, 100, 50, 100, high-dose,
Jones, 2013, 12345678, 50, 100, 50, 100, low-dose,
Smith, 2014, 12345678, 50, 100, 50, 100, high-dose,
Snead, 2015, 12345678, 50, 100, 50, 100, low-dose,
Parks, 2016, 12345678, 50, 100, 50, 100, high-dose,</div>
	
			<div id="analysis_type" style="width:600px;">
			<fieldset style="border: 3px solid #6DC6E7">
            <div style="float:left">
			<select id="type" style="float:left">
              <option value="ignore" selected>Meta-analysis without subgroup</option>
              <option value="subgroup1">Meta-analysis with subgroup using cofactor 1</option>
              <option value="subgroup2">Meta-analysis with subgroup using cofactor 2</option>
              <option value="subgroup3">Meta-analysis with subgroup using cofactor 3</option>
              <option value="subgroup4">Meta-analysis with subgroup using cofactor 4</option>
              <option value="subgroup5">Meta-analysis with subgroup using cofactor 5</option>
              <option value="subgroup6">Meta-analysis with subgroup using cofactor 6</option>
              <option value="subgroup7">Meta-analysis with subgroup using cofactor 7</option>
              <option value="subgroup8">Meta-analysis with subgroup using cofactor 8</option>
              <option value="subgroup9">Meta-analysis with subgroup using cofactor 9</option>
              <option value="subgroup10">Meta-analysis with subgroup using cofactor 10</option>
              <option value="metaregression">Meta-regression</option>
            </select>
			</div>

            <div style="float:right">

			<select id="measure" style="width:200px;float:right">
              <option value="OR" selected>Odds ratio</option>
              <option value="RR">Relative risk</option>
              <option value="MD">Mean difference</option>
              <option value="SMD">Standardized mean difference</option>
              <option value="ROM">Ratio of means</option>
            </select>
			</div>
			</fieldset>
			<div style="clear:both"></div>
			</div>

			<!-- Start of meta-analysis form -->
			<div id="metaanalysis_form" style="width:600px;clear:both">
			<fieldset class="options">
            <legend style="font-weight:bold">Meta-analysis settings</legend>
			<div id="metaanalysis_form_left" style="width:250px;float:left">
				<label>Sort order:</label>
				<select id="sortby" style="width:200px">
				  <option value="cofactor1">Cofactor 1 (ascending)</option>
				  <option value="cofactor2">Cofactor 2 (ascending)</option>
				  <option value="cofactor3">Cofactor 3 (ascending)</option>
				  <option value="cofactor4">Cofactor 4 (ascending)</option>
				  <option value="cofactor5">Cofactor 5 (ascending)</option>
				  <option value="cofactor6">Cofactor 6 (ascending)</option>
				  <option value="cofactor7">Cofactor 7 (ascending)</option>
				  <option value="cofactor8">Cofactor 8 (ascending)</option>
				  <option value="cofactor9">Cofactor 9 (ascending)</option>
				  <option value="cofactor10">Cofactor 10 (ascending)</option>
				  <option value="baseline">Baseline value in control group</option>
				  <option value="study">Study name</option>
				  <option value="weight">Weight (descending)</option>
				  <option value="year" selected>Year (ascending)</option>
				</select><br/>
				<div>&nbsp;</div>
				<label>Left label:</label> 
				<input type="text" id="lefthand" value="Favors experimental" style="width:150px" /> 
			</div>
			<div id="metaanalysis_form_right" style="width:325px;float:right">
				<a href="#" class="hastip">Analysis method</a>:<div class="tooltiptext">Knapp-Hartung adjustment should be clicked unless heterogeneity is insig per PMID: <a href="http://pubmed.gov/24727843">24727843</a>. However, unclick this if yields wacky confidence intervals when less than 5 studies available.</div>
				<select id="analysis">
				  <option value="RE-Knapp-Hartung" selected>Random effects with Knapp-Hartung adjustment</option>
				  <option value="RE">Random effects</option>
				  <option value="FE">Fixed effects (ok if heterogeneity is insignificant)</option>
				</select>
			<div>&nbsp;</div>
			<label>Right label:</label> 
			<input type="text" id="righthand" value="Favors control" style="width:150px" /> 
			<!--<select id="righthand">
			  <option value="favors experimental">favors experimental</option>
			  <option value="favors control" selected>favors control</option>
			</select>-->
			</div> 
			</fieldset>
			</div>

			<!-- Start of meta-regression form -->
			<div id="metaregression_form" style="display:none;width:600px;clear:both">
			<fieldset class="options">
            <legend style="font-weight:bold">Meta-regression settings</legend>
			<div id="metaanalysis_form_left" style="width:250px;float:left">
			<select id="label_location" style="width:200px;float:left">
              <option value="" selected>No labels for points</option>
              <option value="1">Below points</option>
              <option value="2">Left of points</option>
              <option value="3">Above points</option>
              <option value="4">Right of points</option>
            </select>
            </div>
			<div id="metaanalysis_form_right" style="width:250px;float:right">
			<select id="independent_variable" style="width:250px;float:right">
              <option value="na" selected>Select independent variable</option>
              <option value="size">Study size</option>
              <option value="year">Year</option>
              <option value="cr">Control rate</option>
              <option value="cf1">Cofactor 1</option>
              <option value="cf2">Cofactor 2</option>
              <option value="cf3">Cofactor 3</option>
              <option value="cf4">Cofactor 4</option>
              <option value="cf5">Cofactor 5</option>
              <option value="cf6">Cofactor 6</option>
              <option value="cf7">Cofactor 7</option>
              <option value="cf8">Cofactor 8</option>
              <option value="cf9">Cofactor 9</option>
              <option value="cf10">Cofactor 10</option>
            </select>
			<br>
			<input type="text" id="cofactorlabel" placeholder="Label for cofactor on x-axis" style="width:250px;float:right" /> 
            </div>
			</fieldset>
			</div>
			
			<div style="clear:both">&nbsp;</div>
			<div>
            <label>Topic (for title - optional):</label> 
            <input type="text" id="topic" placeholder="Topic" style="float:right;width:375px"/> 
            <select id="theme" style="display:none">
              <option value="white" selected>None theme</option>
              <option value="KU">KU</option>
            </select>
			</div> 
            <button class="btn btn-small btn-primary" id="plotbutton"><i class="icon-ok icon-white"></i> Update Plot (below)</button>
          </fieldset>
        </form>
      </div>
      <div style="width:350px;float:right">
	          <form name="form2" action="#" style="width:350px;">
          <fieldset style="border: 3px solid #6DC6E7; background-color: #FFFFFF;width:350px;height:800px;">
		  <legend style="font-weight:bold">Example analyses</legend>
			<h3 style="margin-bottom:0px">Teaching example 1: Soma (fictitious)</h3>
			<div >Fictitious example based on <a href="http://en.wikipedia.org/wiki/Brave_New_World">Brave New World</a></div>
			<div><input type="radio" name="example" class="example" value="ex_0" id="ex_0" /><label for="ex_0">Soma dataset</label>
				<i>
				<div class="teach">Before making the plot</div>
				<ul class="teach">
				<li>Do you believe Soma will show a benefit when the studies are pooled?</li>
				</ul>
				<div class="teach">Now, look at the plot</div>
				<ul class="teach">
				<li>What does I<sup>2</sup> indicate? (<a href="http://handbook-5-1.cochrane.org/chapter_9/9_5_2_identifying_and_measuring_heterogeneity.htm">help</a>)</li>
				</ul>
				</i>
			</div>
			<div><input type="radio" name="example" class="example" value="ex_0a" id="ex_0a" /><label for="ex_0a">Soma dataset, second version</label>
				<i>
				<div class="teach">Before making the plot</div>
				<ul class="teach">
				<li>Do you believe Soma will show a benefit when the studies are pooled?</li>
				</ul>
				<div class="teach">Now, look at the plot</div>
				<ul class="teach">
				<li>What does I<sup>2</sup> indicate? (<a href="http://handbook-5-1.cochrane.org/chapter_9/9_5_2_identifying_and_measuring_heterogeneity.htm">help</a>)</li>
				</ul>
				</i>
			</div>
			<h3 style="margin-bottom:0px">Teaching example 2: back pain treatment with tramadol</h3>
			<div >From PMID <a href="http://pubmed.gov/29204613">29204613</a></div>
			<div><input type="radio" name="example" class="example" value="ex_0b" id="ex_0b" /><label for="ex_0">Tramadol dataset</label>
			</div>
		  
		  <h3 style="margin-bottom:0px">Meta-analysis of binary outcomes</h3>
		  <div >Example: <a href="https://github.com/openMetaAnalysis/Vitamin-D-for-fracture-prevention/blob/master/README.md">vitamin D for the prevention of osteoporotic fractures</a>.</div>
			<div><input type="radio" name="example" class="example" value="ex_1a" id="ex_1a" /><label for="ex_1a">Include all studies; no subgroups</label> 
			<i class="teach">When pooled, is there a significant difference? What does i-squared suggest?</i></div>
			<div><input type="radio" name="example" class="example" value="ex_1b" id="ex_1b"/><label for="ex_1b">Subgroup</label> 
			<i class="teach">What does subgrouping reveal?</i></div>

			<h3 style="margin-bottom:0px">Meta-analysis of continuous outcomes</h3>
		  <div >Example: <a href="http://openmetaanalysis.github.io/Hypertonic-Saline-for-Bronchiolitis/">hypertonic saline to reduce length of stay in hospitalized children with bronchiolitis</a></div>
			<div><input type="radio" name="example" class="example" value="ex_2a" id="ex_2a" /><label for="ex_2a">Include all studies; no subgroups</label>
			<i class="teach">When pooled, is there a significant difference? What does i-squared suggest?</i>
			</div>
			<div ><a href="#" class="hastip">About standardized mean differences</a>
				<div class="tooltiptext">
				The standardized mean difference (SMD) is:<br/>
				<img src="smd.png" alt="SMD"/><br/>
				In the interpretation of SMD:
				<ul>
					<li>0.2 represents a small effect</li>
					<li>0.5 a moderate effect</li>
					<li>> 0.8 a large effect</li> 
				</ul>
				<div >The 'standardization' allows pooling of different types of outcomes.</div>
				<div >From: Cochrane Handbook. 12.6  <a href="http://handbook-5-1.cochrane.org/chapter_12/12_6_2_re_expressing_smds_using_rules_of_thumb_for_effect_sizes.htm">Interpreting results from continuous outcomes (including standardized mean differences)</a></div>
				</div>
			</div>
			<h3 style="margin-bottom:0px">Meta-regression</h3>
		  <div >Example: <a href="https://github.com/openMetaAnalysis/Vitamin-D-for-fracture-prevention/blob/master/README.md">vitamin D for the prevention of osteoporotic fractures</a>.</div>
			<div><input type="radio" name="example" class="example" value="ex_3a" id="ex_3a"/><label for="ex_3a">Meta-regression of final Vitamin D level.</label>
			<i class="teach">What is the relationship between the final vitamin D level and the risk of fracture?</i>
			</div>
			<div><input type="radio" name="example" class="example" value="ex_3b" id="ex_3b"/><label for="ex_3b">Meta-regression of change in Vitamin D level</label> 
			<i class="teach">What is the relationship between the change in vitamin D level and the risk of fracture?</i>
			</div>
			<div>&nbsp;</div>
		  <div >Example: <a href="http://openmetaanalysis.github.io/Hypertonic-Saline-for-Bronchiolitis/">Early goal-directed therapy for reducing mortality from septic shock</a>.</div>
			<div><input type="radio" name="example" class="example" value="ex_3c" id="ex_3c"/><label for="ex_3c">Meta-regression of reduction in mortality by baseline lactate level</label> 
			<i class="teach">What is the relationship between reduction in mortality and the baseline serum lactate? How about with the morality in the control group?</i>
			</div>
	  </fieldset>
</form>
	</div>
	
	<div style="clear:both">&nbsp;</div>
	</div>
	<div >Hint: if bad spacing between title/footer text and the plot, click 'png' file type in upper right of plot. Then after the image opens in a new browser window, alter the image's dimensions in the url of the window. <a href="images/plot.resize.png" title="Click to display example in a new window" target="_blank">Click here to see screen capture of an example</a>.&nbsp;<img src="images/External.svg.png" alt="opens in new window" width="13"></div>
      <div class="span9">
        <div id="plotdiv"></div>
      </div>
	      <div class="span12">
        <h3>About</h3>
        <h4>Technical details</h4>
        <p>This is an OpenCPU application.</p>
		<p>Please help improve this application <br/>by editing the source code.</p>
        <table class="table table-striped">
          <tr><th>Resource</th> <th>link</th></tr>
          <tr><td>Package Info</td> <td><a href=".." target="blank">link</a></td></tr>       
          <tr><td>Function Source</td><td><a href="../R/intervention/print" target="blank">link</a></td><td></tr>
          <tr><td>Source Code</td><td><a href="https://github.com/openMetaAnalysis/home" target="blank">link</a></td><td></tr>
          <tr><td>Help Page (html)</td><td><a href="../man/open-meta-analysis/text" target="blank">link</a></td><td></tr>
        </table>
               
      </div>
</div> <!-- end of container -->
<script>
//For gh-pages
//Page history and edit
var pagename = location.pathname.split('/').slice(-1);
if (pagename.length < 1){pagename = "index.html"}
document.write("<div style='text-align:center'><a href='https://github.com/openMetaAnalysis/home/blob/master/inst/www/" + pagename + "'>Edit this page</a> - <a href='https://github.com/openMetaAnalysis/home/commits/master/inst/www/" + pagename + "'>Page history</a></div>")
</script>
</div>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>	
</body>
</html>
